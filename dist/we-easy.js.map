{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///d:/.workspace/.open/we-easy/src/app.js","webpack:///d:/.workspace/.open/we-easy/src/component.js","webpack:///d:/.workspace/.open/we-easy/src/core/before-mount.js","webpack:///d:/.workspace/.open/we-easy/src/core/created.js","webpack:///d:/.workspace/.open/we-easy/src/core/mounted.js","webpack:///d:/.workspace/.open/we-easy/src/index.js","webpack:///d:/.workspace/.open/we-easy/src/mixins/earlier.js","webpack:///d:/.workspace/.open/we-easy/src/mixins/later.js","webpack:///d:/.workspace/.open/we-easy/src/page.js","webpack:///d:/.workspace/.open/we-easy/src/plugins/data-computed.js","webpack:///d:/.workspace/.open/we-easy/src/plugins/data-proxify.js","webpack:///d:/.workspace/.open/we-easy/src/plugins/data-watcher.js","webpack:///d:/.workspace/.open/we-easy/src/plugins/next-tick.js","webpack:///d:/.workspace/.open/we-easy/src/utils/diff.js","webpack:///d:/.workspace/.open/we-easy/src/utils/merge/compute.js","webpack:///d:/.workspace/.open/we-easy/src/utils/merge/function.js","webpack:///d:/.workspace/.open/we-easy/src/utils/merge/index.js","webpack:///d:/.workspace/.open/we-easy/src/utils/merge/object.js","webpack:///d:/.workspace/.open/we-easy/src/utils/mixin.js","webpack:///d:/.workspace/.open/we-easy/src/utils/next-tick.js","webpack:///d:/.workspace/.open/we-easy/src/utils/primitive.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;AClFA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAEiC;AACG;AACI;;AAExC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb,KAAK;AACL;AACA;AACA,eAAe;AACf,OAAO;AACP;AACA,eAAe;AACf;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA,eAAe;AACf,OAAO;AACP,MAAM,qDAAO;AACb;AACA,GAAG;AACH;;AAEA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,qDAAU;AACd;;AAEA,YAAY,4DAAK;AACjB,OAAO,UAAU;AACjB;AACA,WAAW;AACX;AACA;;AAEA;;AAEA,OAAO,eAAe;AACtB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA,SAAS;AACT,CAAC;;AAEc,kEAAG;;;;;;;;;;;;;AC1ElB;AAAA;AAAA;AAAA;AAAA;AAAA;;AAEiC;AACM;AACI;;AAE3C;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,SAAS,oCAAoC;AAC7C;AACA;AACA;AACA;AACA,+DAA+D;AAC/D,eAAe,WAAW;;AAE1B;AACA;AACA;;AAEA;AACA;AACA;;AAEA,WAAW;AACX;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEO;AACP;AACA;AACA,IAAI,uDAAY;AAChB;AACA;AACA;AACA;AACA,IAAI,qDAAU;AACd;;AAEA,YAAY,4DAAK;;AAEjB;AACA;;AAEA,OAAO,eAAe;AACtB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA,SAAS;AACT,CAAC;;AAEc,wEAAS;;;;;;;;;;;;;ACjFxB;AAAA;AACe;AACf;AACA,OAAO,cAAc;AACrB;AACA,CAAC;;;;;;;;;;;;;ACLD;AAAA;AAAA;AAAA;;AAEgC;AACS;;AAEzC;;AAEe;AACf;AACA;AACA,WAAW;AACX,GAAG;;AAEH,OAAO,sBAAsB;AAC7B;;AAEA,OAAO,wBAAwB;;AAE/B;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM,gEAAQ;AACd;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA,WAAW;AACX,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA,MAAM,gEAAQ;AACd;AACA;;AAEA;AACA;;AAEA,oBAAoB,2DAAI;AACxB;;AAEA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH,CAAC;;;;;;;;;;;;;AChFD;AAAA;AACe;AACf;;AAEA,OAAO,UAAU;AACjB;AACA,CAAC;;;;;;;;;;;;;ACND;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiC;AACE;AACU;;AAEH;AACM;AACA;AACE;;AAElD;AACA;AACA;AACA;AACA,MAAM,gDAAU;AAChB,MAAM,0DAAe;AACrB;AACA;AACA,CAAC;;AAED;AACA,EAAE,yDAAS;AACX;AACA,EAAE,4DAAU;AACZ,EAAE,2EAAe;AACjB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED,WAAW,0DAAQ;AACnB,WAAW,6DAAW;AACtB,WAAW,8DAAY;AACvB,WAAW,6DAAW;;AAMrB;;AAEc,qEAAM;;;;;;;;;;;;;ACrDrB;AAAA;AAAA;AAAqC;AACA;;AAEtB;AACf,EAAE,8DAAO,EAAE,8DAAO;AAClB,CAAC;;;;;;;;;;;;;ACLD;AAAA;AAA8C;;AAE/B;AACf,WAAW,0DAAW;AACtB,CAAC;;;;;;;;;;;;;ACJD;AAAA;AAAA;AAAA;AAAA;AAAA;;AAEiC;AACM;AACI;;AAE3C;AACA;AACA;AACA;;AAEA;;AAEO;AACP;AACA;AACA,IAAI,uDAAY;AAChB;AACA;AACA;AACA,IAAI,qDAAU;AACd;;AAEA,YAAY,4DAAK;;AAEjB,OAAO,UAAU;AACjB;AACA,WAAW;AACX;AACA;;AAEA;;AAEA,OAAO,eAAe;AACtB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA,SAAS;AACT,CAAC;;AAEc,mEAAI;;;;;;;;;;;;;ACnDnB;AAAA;AAAgC;;AAEhC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,WAAW;AACX,GAAG;AACH;AACA,WAAW;AACX,GAAG;AACH;;AAEA;AACA,OAAO,QAAQ;AACf;AACA,2BAA2B;AAC3B;AACA;;AAEA,SAAS,2DAAI;AACb;;AAEA;AACA,OAAO,yBAAyB;;AAEhC;AACA,MAAM,2DAAI;;AAEV;AACA;AACA;;AAEA;AACA;AACA,SAAS,UAAU;AACnB;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,SAAS,UAAU;AACnB;;AAEA;AACA;AACA,aAAa;AACb,KAAK;;AAEL;AACA,GAAG;AACH;AACA,SAAS,uBAAuB;AAChC;AACA;;AAEA;AACA;AACA;;AAEA,kBAAkB,aAAa;AAC/B;AACA;;AAEA;AACA;;AAEe;AACf;AACA,CAAC;;;;;;;;;;;;;AC/ED;AAAA;AACA;AACA;;AAEA;AACA;AACA;AACA,qCAAqC,KAAK;AAC1C,OAAO;AACP;AACA;AACA,qCAAqC,KAAK;AAC1C;AACA,KAAK;AACL,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,wBAAwB;AACnC;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,aAAa;AACb,KAAK;AACL,GAAG;AACH;AACA,SAAS,wBAAwB;AACjC;AACA;AACA,GAAG;AACH;;AAEA,kBAAkB,aAAa;AAC/B;AACA;;AAEA;AACA;;AAEe;AACf;AACA,CAAC;;;;;;;;;;;;;ACxED;AAAA;AAAgC;;AAEhC;AACA;AACA;AACA;AACA,qDAAqD,IAAI;AACzD;;AAEA;AACA;AACA,cAAc;AACd,KAAK;AACL,cAAc;AACd,KAAK;AACL;AACA;;AAEA;AACA,wEAAwE,IAAI;AAC5E;;AAEA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA,WAAW;AACX,GAAG;;AAEH;AACA,WAAW;AACX,GAAG;;AAEH;AACA;AACA,WAAW;AACX,GAAG;AACH;;AAEA;AACA;AACA;AACA,SAAS,uBAAuB;;AAEhC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,qCAAqC;AACrC,SAAS,uBAAuB;;AAEhC;AACA;;AAEA;AACA;;AAEA,mBAAmB,2DAAI;AACvB;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;;AAEA;AACA;AACA,SAAS,QAAQ;AACjB;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,SAAS,QAAQ;AACjB;;AAEA;AACA;AACA,aAAa;AACb,KAAK;;AAEL;AACA,GAAG;AACH;AACA,SAAS,qBAAqB;AAC9B;AACA;AACA;;AAEA,kBAAkB,aAAa;AAC/B;AACA;;AAEA;AACA;;AAEe;AACf;AACA,CAAC;;;;;;;;;;;;;ACrHD;AAAA;AAAyC;;AAEzC;AACA;AACA;AACA,aAAa,8BAA8B,gEAAQ;AACnD,KAAK;AACL;AACA;;AAEA,kBAAkB,aAAa;AAC/B;AACA;;AAEA;AACA;;AAEe;AACf;AACA,CAAC;;;;;;;;;;;;;ACnBD;AAAA;AAAyC;;AAEzC;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;;AAEA;AACA,MAAM,8DAAW,UAAU,8DAAW;AACtC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEe,mEAAI;;;;;;;;;;;;;AChDnB;AAAe;AACf;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK,IAAI;AACT;AACA,CAAC;;;;;;;;;;;;;ACxBD;AAAe;AACf;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,CAAC;;;;;;;;;;;;;ACvBD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiD;AACE;AACE;;;;;;;;;;;;;ACFrD;AAAe;AACf,yBAAyB;AACzB,CAAC;;;;;;;;;;;;;ACFD;AAAA;AAAwE;;AAExE;AACA;AACA;AACA;AACA,iBAAiB,iEAAY;AAC7B,KAAK;AACL,iBAAiB,kEAAa;AAC9B,KAAK;AACL,iBAAiB,gEAAW;AAC5B;AACA,GAAG;;AAEH;AACA;;;AAGA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEe;AACf;AACA;;AAEA;AACA,CAAC;;;;;;;;;;;;;ACvCD;AAAe;AACf;AACA;AACA;AACA,GAAG;AACH,CAAC;;;;;;;;;;;;;ACLD;AAAA;AAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEO;AACP;AACA","file":"we-easy.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"d:\\\\.workspace\\\\.open\\\\we-easy\\\\src\\\\index.js\");\n","// global App\r\n\r\nimport mixin from './utils/mixin'\r\nimport mounted from './core/mounted'\r\nimport laterMixin from './mixins/later';\r\n\r\nconst propMap = {\r\n  'created': 'onLaunch',\r\n}\r\n\r\nconst earlierMixin = {\r\n  created() {\r\n    let app = this\r\n    Object.defineProperty(wx, '$app', {\r\n      get() { return app }\r\n    })\r\n    Object.defineProperties(this, {\r\n      $pages: {\r\n        get() { return getCurrentPages() }\r\n      },\r\n      $page: {\r\n        get() { return getCurrentPages().pop() }\r\n      }\r\n    })\r\n  },\r\n  onShow() {\r\n    if (!this.$$mounted) {\r\n      Object.defineProperty(this, '$$mounted', {\r\n        get() { return true }\r\n      })\r\n      mounted.call(this)\r\n    }\r\n  },\r\n}\r\n\r\nconst globalMixins = []\r\n\r\nexport function WeEasyApp(options) {\r\n  options = options || {}\r\n  let mixins = [\r\n    earlierMixin,\r\n    ...globalMixins,\r\n    ...(options.mixins || []),\r\n    options,\r\n    laterMixin,\r\n  ]\r\n\r\n  let opt = mixin(mixins, propMap)\r\n  let { methods } = opt\r\n  if (methods) {\r\n    opt = { ...opt, ...methods }\r\n    delete opt.methods\r\n  }\r\n\r\n  opt.$getOption = () => opt\r\n\r\n  let { beforeCreate } = opt\r\n  if (typeof(beforeCreate) === 'function') {\r\n    beforeCreate(opt)\r\n  }\r\n\r\n  return App(opt)\r\n}\r\n\r\nObject.defineProperty(WeEasyApp, 'mixin', {\r\n  get() {\r\n    return mixin => globalMixins.push(mixin)\r\n  }\r\n})\r\n\r\nObject.defineProperty(App, 'define', {\r\n  get() { return WeEasyApp }\r\n})\r\n\r\nexport default App\r\n","// global Component\r\n\r\nimport mixin from './utils/mixin'\r\nimport laterMixin from './mixins/later'\r\nimport earlierMixin from './mixins/earlier'\r\n\r\nconst propMap = {\r\n  'props': 'properties',\r\n  'mounted': 'ready',\r\n}\r\n\r\nconst globalMixins = []\r\n\r\nconst defaultMixin = {\r\n  beforeCreate(opt) {\r\n    let { properties: props, watch, compute } = opt\r\n    if (props && (watch || compute)) {\r\n      Object.keys(props).forEach(key => {\r\n        let prop = props[key]\r\n        if (prop) {\r\n          if (typeof (prop) !== 'object') prop = props[key] = { type: prop };\r\n          let { observer } = prop\r\n\r\n          prop.observer = ((key, observer) => function (nv) {\r\n            if (typeof (observer) === 'string') observer = this[observer];\r\n            observer && observer.apply(this, arguments)\r\n\r\n            let data = {}\r\n            data[key] = nv\r\n            this.$notifyUpdated(data)\r\n\r\n          })(key, observer)\r\n        }\r\n      })\r\n    }\r\n  },\r\n  created() {\r\n    Object.defineProperty(this, '$emit', {\r\n      get() {\r\n        return function () {\r\n          this.triggerEvent.apply(this, arguments)\r\n        }\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nexport function WeEasyComponent(options) {\r\n  options = options || {}\r\n  let mixins = [\r\n    earlierMixin,\r\n    defaultMixin,\r\n    ...globalMixins,\r\n    ...(options.mixins || []),\r\n    options,\r\n    laterMixin,\r\n  ]\r\n\r\n  let opt = mixin(mixins, propMap)\r\n\r\n  opt.methods = opt.methods || {}\r\n  opt.methods.$getOption = () => opt\r\n\r\n  let { beforeCreate } = opt\r\n  if (typeof(beforeCreate) === 'function') {\r\n    beforeCreate(opt)\r\n  }\r\n\r\n  return Component(opt)\r\n}\r\n\r\nObject.defineProperty(WeEasyComponent, 'mixin', {\r\n  get() {\r\n    return mixin => globalMixins.push(mixin)\r\n  }\r\n})\r\n\r\nObject.defineProperty(Component, 'define', {\r\n  get() { return WeEasyComponent }\r\n})\r\n\r\nexport default Component\r\n","// before existing created() hook\r\nexport default function() {\r\n  // console.log('before-mount')\r\n  let { beforeMount } = this.$getOption()\r\n  beforeMount && beforeMount.call(this)\r\n}\r\n","// earlier action in created() hook\r\n\r\nimport diff from '../utils/diff'\r\nimport nextTick from '../utils/next-tick'\r\n\r\nlet uid = 0\r\n\r\nexport default function() {\r\n  let myuid = ++uid\r\n  Object.defineProperty(this, '$uid', {\r\n    get() { return myuid }\r\n  })\r\n\r\n  let { $getOption, setData } = this\r\n  if (!$getOption || !setData) return;\r\n\r\n  let { beforeUpdate, updated } = this.$getOption()\r\n\r\n  let updatedDataCache = null\r\n  let notifyUpdated = data => {\r\n    if (!updated) return;\r\n\r\n    data = data || this.data\r\n    if (!updatedDataCache) {\r\n      updatedDataCache = {}\r\n      nextTick($ => {\r\n        let data = updatedDataCache\r\n        updatedDataCache = null\r\n        updated.call(this, data)\r\n      })\r\n    }\r\n    Object.assign(updatedDataCache, data)\r\n  }\r\n\r\n  Object.defineProperty(this, '$notifyUpdated', {\r\n    get() { return notifyUpdated }\r\n  })\r\n\r\n  let syncSetData = (data, callback) => {\r\n    beforeUpdate && beforeUpdate.call(this, data)\r\n    setData.call(this, data, callback)\r\n\r\n    this.$updateDataProxify && this.$updateDataProxify(data)\r\n    notifyUpdated(data)\r\n  }\r\n\r\n\r\n  let setDataCache = null\r\n  let setDataCallbacks = []\r\n  let asyncSetData = (data, callback) => {\r\n    if (!setDataCache) {\r\n      setDataCache = {}\r\n      nextTick($ => {\r\n        let data = setDataCache\r\n        let callbacks = setDataCallbacks\r\n\r\n        setDataCache = null\r\n        setDataCallbacks = []\r\n\r\n        let delta = diff(data, this.data)\r\n        if (delta === void(0)) return;\r\n\r\n        syncSetData(delta, (function() {\r\n          let args = arguments\r\n          callbacks.forEach(cb => cb.apply(this, args))\r\n        }).bind(this))\r\n      })\r\n    }\r\n\r\n    Object.assign(setDataCache, data)\r\n    callback && setDataCallbacks.push(callback)\r\n  }\r\n\r\n  Object.defineProperty(this, 'setData', {\r\n    get() {\r\n      return (function(data, callback, immediate = false) {\r\n        data && (immediate ? syncSetData : asyncSetData)(data, callback)\r\n      }).bind(this)\r\n    }\r\n  })\r\n}\r\n","// mounted() hook\r\nexport default function() {\r\n  if (!this.$getOption) return;\r\n\r\n  let { mounted } = this.$getOption()\r\n  mounted && mounted.call(this)\r\n}\r\n","import { WeEasyApp } from './app'\r\nimport { WeEasyPage } from './page'\r\nimport { WeEasyComponent } from './component'\r\n\r\nimport NextTick from './plugins/next-tick'\r\nimport DataProxify from './plugins/data-proxify'\r\nimport DataWatcher from './plugins/data-watcher'\r\nimport DataComputed from './plugins/data-computed'\r\n\r\nconst WeEasyBoth = {}\r\nObject.defineProperty(WeEasyBoth, 'mixin', {\r\n  get() {\r\n    return mixin => {\r\n      WeEasyPage.mixin(mixin)\r\n      WeEasyComponent.mixin(mixin)\r\n    }\r\n  }\r\n})\r\n\r\nconst WeEasy = {\r\n  WeEasyApp,\r\n  WeEasyBoth,\r\n  WeEasyPage,\r\n  WeEasyComponent,\r\n}\r\n\r\nObject.defineProperty(WeEasy, 'use', {\r\n  get() {\r\n    return plugin => {\r\n      if (plugin) {\r\n        if (typeof(plugin) === 'object') {\r\n          plugin = plugin.install\r\n        }\r\n      }\r\n      if (typeof(plugin) !== 'function') {\r\n        throw new Error('Invalid plugin value.')\r\n      }\r\n      plugin(this)\r\n    }\r\n  }\r\n})\r\n\r\nWeEasy.use(NextTick)\r\nWeEasy.use(DataProxify)\r\nWeEasy.use(DataComputed)\r\nWeEasy.use(DataWatcher)\r\n\r\nexport {\r\n  WeEasyApp,\r\n  WeEasyPage,\r\n  WeEasyComponent,\r\n}\r\n\r\nexport default WeEasy\r\n","import created from '../core/created'\r\nimport mounted from '../core/mounted'\r\n\r\nexport default {\r\n  created, mounted\r\n}\r\n","import beforeMount from '../core/before-mount'\r\n\r\nexport default {\r\n  created: beforeMount\r\n}\r\n","// global Page\r\n\r\nimport mixin from './utils/mixin'\r\nimport laterMixin from './mixins/later'\r\nimport earlierMixin from './mixins/earlier'\r\n\r\nconst propMap = {\r\n  'created': 'onLoad',\r\n  'mounted': 'onReady',\r\n}\r\n\r\nconst globalMixins = []\r\n\r\nexport function WeEasyPage(options) {\r\n  options = options || {}\r\n  let mixins = [\r\n    earlierMixin,\r\n    ...globalMixins,\r\n    ...(options.mixins || []),\r\n    options,\r\n    laterMixin,\r\n  ]\r\n\r\n  let opt = mixin(mixins, propMap)\r\n\r\n  let { methods } = opt\r\n  if (methods) {\r\n    opt = { ...opt, ...methods }\r\n    delete opt.methods\r\n  }\r\n\r\n  opt.$getOption = () => opt\r\n\r\n  let { beforeCreate } = opt\r\n  if (typeof(beforeCreate) === 'function') {\r\n    beforeCreate(opt)\r\n  }\r\n\r\n  return Page(opt)\r\n}\r\n\r\nObject.defineProperty(WeEasyPage, 'mixin', {\r\n  get() {\r\n    return mixin => globalMixins.push(mixin)\r\n  }\r\n})\r\n\r\nObject.defineProperty(Page, 'define', {\r\n  get() { return WeEasyPage }\r\n})\r\n\r\nexport default Page\r\n","import diff from '../utils/diff'\r\n\r\nfunction computeData(compute, data) {\r\n  // console.log('computing', this.$uid)\r\n  let res = compute.call(this, data)\r\n  if (!res || typeof(res) !== 'object') {\r\n    throw new Error('The \"compute\" method should return a non-null object.')\r\n  }\r\n\r\n  return res\r\n}\r\n\r\nfunction Computer(target, compute) {\r\n  Object.defineProperty(this, 'target', {\r\n    get() { return target }\r\n  })\r\n  Object.defineProperty(this, 'compute', {\r\n    get() { return compute }\r\n  })\r\n}\r\n\r\nComputer.prototype.isSelfUpdate = function(data) {\r\n  let { cache } = this\r\n  if (cache && data) {\r\n    data = Object.assign({}, data)\r\n    Object.keys(cache).forEach(key => (delete data[key]))\r\n  }\r\n\r\n  return diff(data, cache) === void(0)\r\n}\r\n\r\nComputer.prototype.invoke = function(data, immediate = false) {\r\n  let { target, compute, cache } = this\r\n\r\n  let computed = computeData.call(target, compute, data)\r\n  if (diff(computed, cache) === void(0)) return;\r\n\r\n  this.cache = computed\r\n  target.setData(computed, null, !!immediate)\r\n}\r\n\r\nlet mixin = {\r\n  beforeCreate(opt) {\r\n    let { compute } = opt\r\n    if (compute !== void(0)) {\r\n      if (typeof(compute) !== 'function')\r\n        throw new Error('The \"compute\" option should be a method.')\r\n    }\r\n  },\r\n  mounted() {\r\n    // console.log('computed mounted')\r\n    let { compute } = this.$getOption()\r\n    if (!compute) return;\r\n\r\n    let computer = new Computer(this, compute)\r\n    Object.defineProperty(this, '$$computer', {\r\n      get() { return computer }\r\n    })\r\n\r\n    computer.invoke(this.data, true)\r\n  },\r\n  updated(data) {\r\n    let { $$computer: computer } = this\r\n    if (!computer) return;\r\n    if (computer.isSelfUpdate(data)) return;\r\n\r\n    computer.invoke(this.data)\r\n  }\r\n}\r\n\r\nfunction install({ WeEasyBoth }) {\r\n  if (install.installed) return;\r\n  install.installed = true\r\n\r\n  WeEasyBoth.mixin(mixin)\r\n}\r\n\r\nexport default {\r\n  install\r\n}\r\n","function dataProxify(propNames, getter, setter) {\r\n  propNames.forEach(prop => {\r\n    if (this.hasOwnProperty(prop)) return;\r\n\r\n    Object.defineProperty(this, prop, (prop => ({\r\n      get() {\r\n        if (getter) return getter.call(this, prop)\r\n        throw new Error(`Property \"${prop}\" is not readable.`)\r\n      },\r\n      set(value) {\r\n        if (setter) return setter.call(this, prop, value)\r\n        throw new Error(`Property \"${prop}\" is not writable.`)\r\n      }\r\n    }))(prop))\r\n  })\r\n}\r\n\r\nfunction setupDataProxify(data) {\r\n  dataProxify.call(\r\n    this,\r\n    Object.keys(data),\r\n    function(prop) {\r\n      let { $$proxifyCache: cache } = this\r\n      if (cache.hasOwnProperty(prop)) {\r\n        return cache[prop]\r\n      } else {\r\n        return this.data[prop]\r\n      }\r\n    },\r\n    function(prop, value) {\r\n      let data = {}\r\n      data[prop] = value\r\n      this.$$proxifyCache[prop] = value\r\n      return this.setData(data)\r\n    }\r\n  )\r\n}\r\n\r\nlet mixin = {\r\n  created() {\r\n    // console.log('proxify mounted')\r\n    let cache = {}\r\n    Object.defineProperty(this, '$$proxifyCache', {\r\n      get() { return cache }\r\n    })\r\n\r\n    let updateDataProxify = (function (data) {\r\n      data = data || this.data\r\n      setupDataProxify.call(this, data)\r\n    }).bind(this)\r\n\r\n    updateDataProxify()\r\n    Object.defineProperty(this, '$updateDataProxify', {\r\n      get() { return updateDataProxify }\r\n    })\r\n  },\r\n  updated(data) {\r\n    let { $$proxifyCache: cache } = this\r\n    Object.keys(data).forEach(key => (delete cache[key]))\r\n    this.$updateDataProxify(data)\r\n  },\r\n}\r\n\r\nfunction install({ WeEasyBoth }) {\r\n  if (install.installed) return;\r\n  install.installed = true\r\n\r\n  WeEasyBoth.mixin(mixin)\r\n}\r\n\r\nexport default {\r\n  install\r\n}\r\n","import diff from '../utils/diff'\r\n\r\nfunction normalize(watch) {\r\n  Object.keys(watch).forEach(key => {\r\n    let item = watch[key]\r\n    if (!item) {\r\n      throw new Error(`Invalid config for watcher \"${key}\".`)\r\n    }\r\n\r\n    let type = typeof(item)\r\n    if (type === 'function') {\r\n      item = { handler: item }\r\n    } else if (type === 'string') {\r\n      item = { handler: this[item] }\r\n    } else if (typeof(item.handler) === 'string') {\r\n      item.handler = this[item.handler]\r\n    }\r\n\r\n    if (typeof(item.handler) !== 'function') {\r\n      throw new Error(`Invalid handler function specified to watcher \"${key}\".`)\r\n    }\r\n\r\n    watch[key] = item\r\n  })\r\n}\r\n\r\nfunction Watcher(target, watch) {\r\n  normalize.call(target, watch)\r\n  Object.defineProperty(this, 'target', {\r\n    get() { return target }\r\n  })\r\n\r\n  Object.defineProperty(this, 'watch', {\r\n    get() { return watch }\r\n  })\r\n\r\n  let cache = {}\r\n  Object.defineProperty(this, 'cache', {\r\n    get() { return cache }\r\n  })\r\n}\r\n\r\nWatcher.prototype = {\r\n  constructor: Watcher,\r\n  initialize: function () {\r\n    let { target, cache, watch } = this\r\n\r\n    // console.log('initial: ', target.data)\r\n\r\n    let immediates = {}\r\n    let hasImmediates = false\r\n    Object.keys(watch).forEach(key => {\r\n      let val = cache[key] = target.data[key]\r\n      if (watch[key].immediate) {\r\n        hasImmediates = true\r\n        immediates[key] = val\r\n      }\r\n    })\r\n\r\n    if (hasImmediates) {\r\n      this.invoke(immediates, true)\r\n    }\r\n  },\r\n  invoke(data, force = false) {\r\n    // console.log('invoking watcher', data, force)\r\n    let keys = Object.keys(data || {})\r\n    let { target, cache, watch } = this\r\n\r\n    keys && keys.forEach(key => {\r\n      if (!watch.hasOwnProperty(key)) return;\r\n\r\n      let ov = cache[key]\r\n      let nv = data[key]\r\n\r\n      if (force || diff(nv, ov) !== void (0)) {\r\n        cache[key] = nv\r\n        watch[key].handler.call(target, nv, ov)\r\n      }\r\n    })\r\n  },\r\n}\r\n\r\nlet mixin = {\r\n  beforeCreate(opt) {\r\n    let { watch } = opt\r\n    if (watch !== void(0)) {\r\n      if (typeof(watch) !== 'object')\r\n        throw new Error('The \"watch\" option should be an object.')\r\n    }\r\n  },\r\n  beforeMount() {\r\n    // console.log('watcher created')\r\n    let { watch } = this.$getOption()\r\n    if (!watch) return;\r\n\r\n    let watcher = new Watcher(this, watch)\r\n    Object.defineProperty(this, '$$watcher', {\r\n      get() { return watcher }\r\n    })\r\n\r\n    watcher.initialize()\r\n  },\r\n  updated(data) {\r\n    let { $$watcher: watcher } = this\r\n    watcher && watcher.invoke(data, true)\r\n  }\r\n}\r\n\r\nfunction install({ WeEasyBoth }) {\r\n  if (install.installed) return;\r\n  install.installed = true\r\n\r\n  WeEasyBoth.mixin(mixin)\r\n}\r\n\r\nexport default {\r\n  install\r\n}\r\n","import nextTick from '../utils/next-tick'\r\n\r\nlet mixin = {\r\n  created() {\r\n    Object.defineProperty(this, '$nextTick', {\r\n      get() { return (action, callback) => nextTick(action, this, callback) }\r\n    })\r\n  }\r\n}\r\n\r\nfunction install({ WeEasyBoth }) {\r\n  if (install.installed) return;\r\n  install.installed = true\r\n\r\n  WeEasyBoth.mixin(mixin)\r\n}\r\n\r\nexport default {\r\n  install\r\n}\r\n","import { isPrimitive } from './primitive'\r\n\r\nfunction primitiveDiff(x, y) {\r\n  return x === y ? void(0) : x\r\n}\r\n\r\nfunction arrayDiff(x, y, deep) {\r\n  if (!x || !y) return x;\r\n  if (x.length !== y.length) return x;\r\n\r\n  let keys = Object.keys(x)\r\n  let kset = new Set(Object.keys(y))\r\n  if (keys.length != kset.size) return x;\r\n\r\n  return keys.every(key => {\r\n    if (!kset.has(key)) return false;\r\n    let valx = x[key]\r\n    let valy = y[key]\r\n\r\n    return diff(valx, valy, deep) === void(0)\r\n  }) ? void(0) : x\r\n}\r\n\r\nfunction diff(data, target, deep = true) {\r\n  if (isPrimitive(data) || isPrimitive(target)) {\r\n    return primitiveDiff(data, target)\r\n  }\r\n  if (Array.isArray(data) || Array.isArray(target)) {\r\n    return arrayDiff(data, target, deep)\r\n  }\r\n\r\n  let res = {}\r\n  let hasDiff = false\r\n  Object.keys(data).forEach(key => {\r\n    let vd = data[key]\r\n    let vt = target[key]\r\n\r\n    if (vd !== vt) {\r\n      if (!deep || diff(vd, vt, true) !== void(0)) {\r\n        hasDiff = true\r\n        res[key] = vd\r\n      }\r\n    }\r\n  })\r\n\r\n  return hasDiff ? res : void(0)\r\n}\r\n\r\nexport default diff\r\n","export default function(x, y) {\r\n  let array = [x, y].filter(Boolean)\r\n  if (!array.length) return () => {};\r\n\r\n  array.forEach(fn => {\r\n    if (fn && typeof(fn) !== 'function') {\r\n      throw new Error('The \"compute\" property value must be a function.')\r\n    }\r\n  })\r\n\r\n  return function() {\r\n    let args = Array.from(arguments)\r\n    return array.reduce((res, fn) => {\r\n      let computed = fn.apply(this, args)\r\n      if (computed) {\r\n        if (typeof(computed) !== 'object') {\r\n          throw new Error('The \"compute\" function must return an object value.')\r\n        }\r\n        res = Object.assign(res, computed)\r\n      }\r\n\r\n      return res\r\n    }, {})\r\n  }\r\n}\r\n","export default function(x, y) {\r\n  return function() {\r\n    let args = arguments\r\n\r\n    let invoke = fn => {\r\n      let type = typeof(fn)\r\n      if (type === 'function') {\r\n        return fn.apply(this, args)\r\n      } else if (type === 'string') {\r\n        return invoke(this[type])\r\n      } else if (Array.isArray(fn)) {\r\n        let result;\r\n        fn.forEach(x => (result = invoke(x)))\r\n        return result;\r\n      }\r\n    }\r\n\r\n    let array = []\r\n    y && array.push(y)\r\n    x && array.push(x)\r\n\r\n    return invoke(array)\r\n  }\r\n}\r\n","export { default as mergeObject } from './object'\r\nexport { default as mergeCompute } from './compute'\r\nexport { default as mergeFunction } from './function'\r\n","export default function(x, y) {\r\n  return Object.assign({}, x, y)\r\n}\r\n","import { mergeObject, mergeCompute, mergeFunction } from './merge/index'\r\n\r\nfunction mixinOne(obj, mixin) {\r\n  Object.keys(mixin).forEach(key => {\r\n    let value = mixin[key]\r\n    if (key === 'compute') {\r\n      obj[key] = mergeCompute(value, obj[key])\r\n    } else if (typeof(value) === 'function') {\r\n      obj[key] = mergeFunction(value, obj[key])\r\n    } else if (typeof(value) === 'object') {\r\n      obj[key] = mergeObject(value, obj[key])\r\n    }\r\n  })\r\n\r\n  return obj\r\n}\r\n\r\n\r\nfunction remapProps(obj, map) {\r\n  obj = Object.assign({}, obj)\r\n  if (map) {\r\n    Object.keys(map).forEach(key => {\r\n      let prop = obj[key]\r\n      if (prop !== void (0)) {\r\n        let mapKey = map[key]\r\n        obj[mapKey] = prop\r\n        delete obj[key]\r\n      }\r\n    })\r\n  }\r\n\r\n  return obj\r\n}\r\n\r\nexport default function(mixins, propsMap) {\r\n  let result = {}\r\n  mixins && mixins.forEach(x => mixinOne(result, remapProps(x, propsMap)))\r\n\r\n  return result;\r\n}\r\n","export default function(action, context, callback) {\r\n  return setTimeout($ => {\r\n    let result = action.call(context)\r\n    callback && callback.call(context, result)\r\n  }, 0)\r\n}\r\n","// string, number, boolean, null, undefined, symbol\r\n\r\nconst primitiveTypes = new Set([\r\n  'string',\r\n  'number',\r\n  'boolean',\r\n  'undefined',\r\n  'symbol',\r\n])\r\n\r\nconst primitiveObjects = new Set([\r\n  null,\r\n])\r\n\r\nexport function isPrimitive(value) {\r\n  return primitiveTypes.has(typeof(value)) || primitiveObjects.has(value)\r\n}\r\n"],"sourceRoot":""}